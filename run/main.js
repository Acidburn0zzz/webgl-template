define("schedule",["require","exports","module"],function(a,b,c){return function(a){var b,c,d,e;return b=Date.now(),d=b,c=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){return setTimeout(a,1e3/30)},e=function(){var f,g;return f=Date.now(),g=f-b,b=f,a((f-d)/1e3,g/1e3),c(e)},c(e)}}),define("webgl/shader",["require","exports","module"],function(a,b,c){var d,e,f;return e=null,f=function(a,b,c,d){var e,g,h,i,j,k,l,m,n,o;e=c[d];if(b.indexOf(e.name)===-1){i=[],g=b.length,b.push(e.name),a[e.name]={},n=e.source;for(j=0,l=n.length;j<l;j++){h=n[j];if(h.text)a[e.name][h.num]=h.text,i.push({num:h.num,text:h.text,fileno:g});else{o=f(a,b,e.dependencies,h.include);for(k=0,m=o.length;k<m;k++)h=o[k],i.push(h)}}return i}return[]},d=function(){function a(a,b,c){this.gl=a,this.dependencies=c,this.name=b.name,this.lines=b.lines,this.program=this.gl.createProgram(),this.vs=this.gl.createShader(a.VERTEX_SHADER),this.fs=this.gl.createShader(a.FRAGMENT_SHADER),this.gl.attachShader(this.program,this.vs),this.gl.attachShader(this.program,this.fs),this.link(b.vertex,b.fragment)}return a.prototype.link=function(a,b){this.compile(this.vs,a),this.compile(this.fs,b),this.gl.linkProgram(this.program);if(!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))throw this.gl.getProgramInfoLog;return this.attrib_cache={},this.uniform_cache={},this},a.prototype.compile=function(a,b){var c,d,e,g,h,i,j,k,l,m,n,o;h=[],d=[this.name],c={},c[this.name]={};for(i=0,l=b.length;i<l;i++){e=b[i];if(typeof e=="string")h.push(e);else if(e.text)c[this.name][e.num]=e.text,h.push({num:e.num,text:e.text,fileno:0});else{o=f(c,d,this.dependencies,e.include);for(j=0,m=o.length;j<m;j++)e=o[j],h.push(e)}}g="";for(k=0,n=h.length;k<n;k++)e=h[k],typeof e=="string"?g+=e+"\n":g+="#line "+e.num+" "+e.fileno+"\n"+e.text+"\n";return this.gl.shaderSource(a,g),this.gl.compileShader(a),this.gl.getShaderParameter(a,this.gl.COMPILE_STATUS)||this.error(d,c,this.gl.getShaderInfoLog(a)),this},a.prototype.error=function(a,b,c){var d,e,f,g,h,i;throw i=c.match(/(\d+):(\d+)/),f=i[1],h=i[2],e=a[f],g=b[e][(h-1).toString()],d=c.replace(/\d+:\d+/,function(a){return"File: "+e+", Line: "+h}),""+d+"\n"+g},a.prototype.attribLoc=function(a){var b;return b=this.attrib_cache[a],b===void 0&&(b=this.attrib_cache[a]=this.gl.getAttribLocation(this.program,a),b>=0&&this.gl.enableVertexAttribArray(b)),b},a.prototype.use=function(){return this.gl.useProgram(this.program),this},a.prototype.loc=function(a){var b;return b=this.uniform_cache[a],b===void 0&&(b=this.uniform_cache[a]=this.gl.getUniformLocation(this.program,a)),b},a.prototype.i=function(a,b){var c;return c=this.loc(a),c&&this.gl.uniform1i(c,b),this},a.prototype.f=function(a,b){var c;return c=this.loc(a),c&&this.gl.uniform1f(c,b),this},a.prototype.vec2=function(a,b,c){var d;return d=this.loc(a),d&&this.gl.uniform2f(d,b,c),this},a.prototype.vec3=function(a,b,c,d){var e;return e=this.loc(a),e&&this.gl.uniform2f(e,b,c,d),this},a.prototype.vec4=function(a,b,c,d,e){var f;return f=this.loc(a),f&&this.gl.uniform2f(f,b,c,d,e),this},a.prototype.mat4=function(a,b){var c;return c=this.loc(a),c&&this.gl.uniformMatrix4fv(c,!1,b),this},a.prototype.mat3=function(a,b){var c;return c=this.loc(a),c&&this.gl.uniformMatrix3fv(c,!1,b),this},a.prototype.draw=function(a){return a.setPointersForShader(this).draw()},a}()}),define("shaders/spherical_harmonics",["require","exports","module"],function(a,b,c){return{dependencies:{},source:[{text:"struct SHC{",num:0},{text:"vec3 L00, L1m1, L10, L11, L2m2, L2m1, L20, L21, L22;",num:1},{text:"};",num:2},{text:"SHC beach = SHC(",num:4},{text:"vec3( 0.6841148,  0.6929004,  0.7069543),",num:5},{text:"vec3( 0.3173355,  0.3694407,  0.4406839),",num:6},{text:"vec3(-0.1747193, -0.1737154, -0.1657420),",num:7},{text:"vec3(-0.4496467, -0.4155184, -0.3416573),",num:8},{text:"vec3(-0.1690202, -0.1703022, -0.1525870),",num:9},{text:"vec3(-0.0837808, -0.0940454, -0.1027518),",num:10},{text:"vec3(-0.0319670, -0.0214051, -0.0147691),",num:11},{text:"vec3( 0.1641816,  0.1377558,  0.1010403),",num:12},{text:"vec3( 0.3697189,  0.3097930,  0.2029923)",num:13},{text:");",num:14},{text:"vec3 shLight(vec3 normal, SHC l){",num:16},{text:"float x = normal.x;",num:17},{text:"float y = normal.y;",num:18},{text:"float z = normal.z;",num:19},{text:"const float C1 = 0.429043;",num:21},{text:"const float C2 = 0.511664;",num:22},{text:"const float C3 = 0.743125;",num:23},{text:"const float C4 = 0.886227;",num:24},{text:"const float C5 = 0.247708;",num:25},{text:"return (",num:27},{text:"C1 * l.L22 * (x * x - y * y) +",num:28},{text:"C3 * l.L20 * z * z +",num:29},{text:"C4 * l.L00 -",num:30},{text:"C5 * l.L20 +",num:31},{text:"2.0 * C1 * l.L2m2 * x * y +",num:32},{text:"2.0 * C1 * l.L21  * x * z +",num:33},{text:"2.0 * C1 * l.L2m1 * y * z +",num:34},{text:"2.0 * C2 * l.L11  * x +",num:35},{text:"2.0 * C2 * l.L1m1 * y +",num:36},{text:"2.0 * C2 * l.L10  * z",num:37},{text:");",num:38},{text:"}",num:39}],name:"src/shaders/spherical_harmonics.glsl"}}),define("shaders/display",["require","exports","module","webgl/shader","./spherical_harmonics"],function(a,b,c){var d=a("webgl/shader"),e={"./spherical_harmonics":a("./spherical_harmonics")};return function(a){return new d(a,{fragment:["precision highp int;","precision highp float;","precision highp vec2;","precision highp vec3;","precision highp vec4;","precision highp ivec2;","precision highp ivec3;","precision highp ivec4;",{text:"varying vec3 vNormal;",num:0},{include:"./spherical_harmonics"},{text:"void main(){",num:15},{text:"vec3 normal = normalize(vNormal);",num:16},{text:"vec3 incident = shLight(normal, beach);",num:17},{text:"gl_FragColor = vec4(incident, 1.0);",num:18},{text:"}",num:19}],vertex:["precision highp int;","precision highp float;","precision highp vec2;","precision highp vec3;","precision highp vec4;","precision highp ivec2;","precision highp ivec3;","precision highp ivec4;",{text:"varying vec3 vNormal;",num:0},{include:"./spherical_harmonics"},{text:"attribute vec3 position, normal;",num:5},{text:"uniform mat4 proj, view, model;",num:6},{text:"void main(){",num:8},{text:"vNormal = mat3(model) * normal;",num:9},{text:"gl_Position = proj * view * model * vec4(position, 1.0);",num:10},{text:"}",num:11}],name:"src/shaders/display.shader"},e)}}),define("webgl/cube",["require","exports","module"],function(a,b,c){var d;return d=function(){function e(a,b){var c,d,e;this.gl=a,d=b||1,e=[-d,-d,-d,0,0,-1,-d,d,-d,0,0,-1,d,d,-d,0,0,-1,d,-d,-d,0,0,-1,-d,-d,-d,0,0,-1,d,d,-d,0,0,-1,d,d,d,0,0,1,-d,d,d,0,0,1,-d,-d,d,0,0,1,d,d,d,0,0,1,-d,-d,d,0,0,1,d,-d,d,0,0,1,-d,d,-d,0,1,0,-d,d,d,0,1,0,d,d,d,0,1,0,d,d,-d,0,1,0,-d,d,-d,0,1,0,d,d,d,0,1,0,d,-d,d,0,-1,0,-d,-d,d,0,-1,0,-d,-d,-d,0,-1,0,d,-d,d,0,-1,0,-d,-d,-d,0,-1,0,d,-d,-d,0,-1,0,-d,-d,-d,-1,0,0,-d,-d,d,-1,0,0,-d,d,d,-1,0,0,-d,d,-d,-1,0,0,-d,-d,-d,-1,0,0,-d,d,d,-1,0,0,d,d,d,1,0,0,d,-d,d,1,0,0,d,-d,-d,1,0,0,d,d,d,1,0,0,d,-d,-d,1,0,0,d,d,-d,1,0,0],c=new Float32Array(e),this.buffer=this.gl.createBuffer(),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer),this.gl.bufferData(this.gl.ARRAY_BUFFER,c,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,null)}var a,b,c,d;return a=Float32Array.BYTES_PER_ELEMENT,c=0,b=3,d=6*a,e.prototype.setPointer=function(b,c,e,f){var g;return g=f.attribLoc(b),g>=0&&this.gl.vertexAttribPointer(g,c,this.gl.FLOAT,!1,d,e*a),this},e.prototype.setPointersForShader=function(a){return this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffer),this.setPointer("position",3,c,a),this.setPointer("normal",3,b,a),this},e.prototype.draw=function(a){return a&&setPointersForShader(a),this.gl.drawArrays(this.gl.TRIANGLES,0,36),this},e}()}),define("matrix",["require","exports","module"],function(a,b,c){window.mat4=function(){return(new Float32Array(16)).m4identity()},Float32Array.prototype.perspective=function(a,b,c,d){var e,f,g,h,i,j,k,l;return h=Math,k=h.tan,i=h.PI,e=a/360*i,l=c*k(e),f=-l,j=l*b,g=-j,this[0]=2*c/(j-g),this[8]=(j+g)/(j-g),this[5]=2*c/(l-f),this[9]=(l+f)/(l-f),this[10]=-(d+c)/(d-c),this[14]=-(2*d*c)/(d-c),this[11]=-1,this},Float32Array.prototype.m4identity=function(){return this[0]=1,this[1]=0,this[2]=0,this[3]=0,this[4]=0,this[5]=1,this[6]=0,this[7]=0,this[8]=0,this[9]=0,this[10]=1,this[11]=0,this[12]=0,this[13]=0,this[14]=0,this[15]=1,this},Float32Array.prototype.m4translate=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o;return d=this[0],e=this[1],f=this[2],g=this[3],h=this[4],i=this[5],j=this[6],k=this[7],l=this[8],m=this[9],n=this[10],o=this[11],this[12]=d*a+h*b+l*c+this[12],this[13]=e*a+i*b+m*c+this[13],this[14]=f*a+j*b+n*c+this[14],this[15]=g*a+k*b+o*c+this[15],this},Float32Array.prototype.m4rotatex=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;return l=Math,o=l.sin,k=l.cos,p=2*l.PI,m=p*(a/360),n=o(m),j=k(m),b=this[4],c=this[5],d=this[6],e=this[7],f=this[8],g=this[9],h=this[10],i=this[11],this[4]=b*j+f*n,this[5]=c*j+g*n,this[6]=d*j+h*n,this[7]=e*j+i*n,this[8]=b*-n+f*j,this[9]=c*-n+g*j,this[10]=d*-n+h*j,this[11]=e*-n+i*j,this},Float32Array.prototype.m4rotatey=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;return l=Math,o=l.sin,k=l.cos,p=2*l.PI,m=p*(a/360),n=o(m),j=k(m),b=this[0],c=this[1],d=this[2],e=this[3],f=this[8],g=this[9],h=this[10],i=this[11],this[0]=b*j+f*-n,this[1]=c*j+g*-n,this[2]=d*j+h*-n,this[3]=e*j+i*-n,this[8]=b*n+f*j,this[9]=c*n+g*j,this[10]=d*n+h*j,this[11]=e*n+i*j,this}}),define("main",["require","exports","module","schedule","./shaders/display","webgl/cube","matrix"],function(a,b,c){var d,e,f;f=a("schedule"),e=a("./shaders/display"),d=a("webgl/cube"),a("matrix"),$(function(){var a,b,c,g,h,i,j,k,l,m;return a=$("canvas"),g=a[0].getContext("experimental-webgl"),c=!0,c&&(g=WebGLDebugUtils.makeDebugContext(g,function(a,b,c){throw"function: "+b+": "+WebGLDebugUtils.glEnumToString(a)})),l=new e(g),b=new d(g,.5),i=mat4(),m=mat4(),h=mat4(),j=function(){var b,c;return c=a.width(),b=a.height(),a[0].width=c,a[0].height=b,g.viewport(0,0,c,b),i.perspective(60,c/b,.1,10)},$(window).resize(j),j(),g.clearColor(.2,.2,.2,1),g.enable(g.CULL_FACE),k=0,f(function(a,c){return k+=c*60,m.m4identity().m4translate(0,0,-1).m4rotatex(30).m4rotatey(45),h.m4identity().m4rotatey(k),g.clear(g.COLOR_BUFFER_BIT),l.use().mat4("proj",i).mat4("view",m).mat4("model",h).draw(b)})})})